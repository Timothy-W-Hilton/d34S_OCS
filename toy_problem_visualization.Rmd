---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.1'
      jupytext_version: 1.2.4
  kernelspec:
    display_name: d34Shv
    language: python
    name: d34shv
---

```{python}
import toy_problem as TP

import holoviews as hv
import geoviews as gv
import geoviews.feature as gf
import xarray as xr  # want this in toy_problem.py eventuall
import hvplot.xarray

from stem_pytools.domain import calc_grid_area
from timutils.git_tools import print_cwd_git_version
```

```{python}
hv.extension('bokeh')
print_cwd_git_version()
```

```{python}
draw_plots = False
```

```{python}
# da_of, anthro_conc, ocean_conc, plant_conc = TP.main()
(plant_flux_highres, plant_flux_lowres, 
 ocean_flux, anthro_flux, 
 anthro_conc, ocean_conc, plant_conc) = TP.main()
```

```{python}
# ocean fluxes, Kettle grid
# OFKG = gv.Dataset(ocean_flux_KG).to(gv.QuadMesh, kdims=['lon', 'lat']) * gf.coastline
# ocean fluxes, regridded to match Jim's GEOS-Chem run
OF = gv.Dataset(ocean_flux).to(gv.QuadMesh, kdims=['longitude', 'latitude']) * gf.coastline
if draw_plots:
    OF #+ OFKG
```

```{python}
qm_anthro = gv.Dataset(anthro_conc['COS'].sel(lev=1)).to(gv.QuadMesh, kdims=['lon', 'lat'])
if draw_plots:
    qm_anthro
```

```{python}
qm_anthro = anthro_conc['COS'].sel(lev=1).hvplot.quadmesh('lon', 'lat', coastline=True)
if draw_plots:
    qm_anthro
```

```{python}
draw_plots = True
qm_anthro = anthro_flux.anthro_flux_permonth.hvplot.quadmesh('longitude', 'latitude', coastline=True)
if draw_plots:
    qm_anthro
```

```{python}
qm_fplant_lowres = plant_flux_lowres['fOCS'].hvplot.quadmesh('lon', 'lat', coastline=True, label='2.5 x 2.0')
qm_fplant_highres = plant_flux_highres['fOCS'].hvplot.quadmesh('lon', 'lat', coastline=True, label='1.25 x 1.0')
if draw_plots:
    qm_fplant
```

```{python}
qm_fplant_lowres + qm_fplant_highres
```
